<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Hostsblock by gaenserich</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>Hostsblock</h1>
        <p>an ad- and malware-blocking cronscript for Linux</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/gaenserich/hostsblock" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/gaenserich/hostsblock/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/gaenserich/hostsblock/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <h1>
<a name="news" class="anchor" href="#news"><span class="octicon octicon-link"></span></a>News</h1>

<p>To participate in the ongoing discussion on <code>hostsblock</code>, check out its <a href="https://bbs.archlinux.org/viewtopic.php?id=139784">Arch Linux forum</a> or its <a href="https://aur.archlinux.org/packages.php?ID=58976">Arch User Repository page</a>.</p>

<h5>
<a name="version-012-31052013" class="anchor" href="#version-012-31052013"><span class="octicon octicon-link"></span></a>Version 0.12 (31.05.2013)</h5>

<ul>
<li>changed order of processing of black and while lists.</li>
</ul><h5>
<a name="version-0113-31052013" class="anchor" href="#version-0113-31052013"><span class="octicon octicon-link"></span></a>Version 0.11.3 (31.05.2013)</h5>

<ul>
<li>changed installation path according to new Arch Linux practices.</li>
</ul><h5>
<a name="debian-package-now-available-19022013" class="anchor" href="#debian-package-now-available-19022013"><span class="octicon octicon-link"></span></a>Debian Package Now Available! (19.02.2013)</h5>

<p>Sadi Yumu≈üak has been so kind as to create a debian package of this util, available in one of the downloads above (zip or tar).</p>

<h5>
<a name="version-0112-09122012" class="anchor" href="#version-0112-09122012"><span class="octicon octicon-link"></span></a>Version 0.11.2 (09.12.2012)</h5>

<ul>
<li>swapped out use of md5sums for ls mod times to improve performance</li>
</ul><h5>
<a name="version-0111-13092012" class="anchor" href="#version-0111-13092012"><span class="octicon octicon-link"></span></a>Version 0.11.1 (13.09.2012)</h5>

<ul>
<li>accumulated fixes with feedback (thanks tlvince)</li>
<li>fixed hostsblock-urlcheck's misidentification of colons in urls</li>
</ul><h5>
<a name="new-webpage-30082012" class="anchor" href="#new-webpage-30082012"><span class="octicon octicon-link"></span></a>New Webpage (30.08.2012)</h5>

<p>In order to centralize resources, I'm migrating all of <code>hostsblock</code>'s web presence to github.com.</p>

<h1>
<a name="description" class="anchor" href="#description"><span class="octicon octicon-link"></span></a>Description</h1>

<p><strong><code>Hostsblock</code></strong> is a bash script for Linux designed to take advantage of the <a href="https://en.wikipedia.org/wiki/Hosts_file">HOSTS file</a> available in all operating systems to provide <a href="http://winhelp2002.mvps.org/hosts.htm">system-wide blocking</a> of internet advertisements, malicious domains, trackers, and other undesirable content. To do so, it downloads a configurable set of blocklists and processes and their entries into a singular HOSTS file.</p>

<p><code>Hostsblock</code> also includes <code>hostsblock-urlcheck</code>, a command-line utility that allows you to block and unblock certain websites and any other domains contained in that website, in the event that the included blocklists don't block enough or block too little on a specific site.</p>

<h1>
<a name="features" class="anchor" href="#features"><span class="octicon octicon-link"></span></a>Features</h1>

<ul>
<li>
<strong>System-wide blocking</strong> (all non-proxied connections use the HOSTS file)</li>
<li>
<strong>Zip- and 7zip-capable</strong> (can download and process zip- and 7zip-compressed files)</li>
<li>
<strong>Non-interactive</strong> (can be run as a periodic cronjob without needing user interaction)</li>
<li>
<strong>Extensive configurability</strong> (allows for custom black and white listing, redirection, post-processing scripting, target HOSTS file, etc.)</li>
<li>
<strong>Bandwith-efficient</strong> (only downloads blocklists that have been changed, uses compression when available)</li>
<li>
<strong>Resource-efficient</strong> (only processes blocklists when changes are registered, uses minimal pipes)</li>
<li>
<strong>High performance blocking</strong> (when using dns caching and pseudo-server daemons)</li>
<li>
<strong>Extensive choice of blocklists included</strong> (allows user to customize how much or how little is blocked)</li>
<li>
<strong>Redirection capability</strong> (combats <a href="https://en.wikipedia.org/wiki/DNS_cache_poisoning">DNS cache poisoning</a>)</li>
</ul><h1>
<a name="screenshots" class="anchor" href="#screenshots"><span class="octicon octicon-link"></span></a>Screenshots</h1>

<p><a href="http://www.personal.psu.edu/jav209/hostsblock-start.png"><img src="http://www.personal.psu.edu/jav209/thumb-hostsblock-start.png" alt="Beginning output of hostsblock. Click to enlarge."></a>
<a href="http://www.personal.psu.edu/jav209/hostsblock-end.png"><img src="http://www.personal.psu.edu/jav209/thumb-hostsblock-end.png" alt="End output of hostsblock. Click to enlarge."></a>
<a href="http://www.personal.psu.edu/jav209/hostsblock-urlcheck.png"><img src="http://www.personal.psu.edu/jav209/thumb-hostsblock-urlcheck.png" alt="Output of hostsblock-urlcheck. Click to enlarge."></a></p>

<h1>
<a name="dependencies" class="anchor" href="#dependencies"><span class="octicon octicon-link"></span></a>Dependencies</h1>

<p><code>Hostsblock</code> only requires a few utilities that are standard on most Linux distros, including <a href="https://www.gnu.org/software/bash/">GNU <code>bash</code></a>, <a href="http://curl.haxx.se/"><code>curl</code></a>, <a href="https://www.gnu.org/software/grep/grep.html">GNU <code>grep</code></a>, <a href="https://www.gnu.org/software/sed/">GNU <code>sed</code></a>, and <a href="https://www.gnu.org/software/coreutils/">GNU <code>coreutils</code></a>.</p>

<h4>
<a name="optional-dependencies" class="anchor" href="#optional-dependencies"><span class="octicon octicon-link"></span></a>Optional dependencies</h4>

<p><code>Hostsblock</code> allows for additional features if the following utilities are installed and in the path:</p>

<p>Unarchivers, so that archive blocklists can be used instead of just plaintext, e.g.:</p>

<ul>
<li>
<a href="http://www.info-zip.org/"><code>unzip</code></a> for zip archives, AND</li>
<li>
<a href="http://p7zip.sourceforge.net/"><code>p7zip</code></a> for 7z archives</li>
</ul><p>A DNS caching daemon to help speed up DNS resolutions, such as:</p>

<ul>
<li>
<a href="http://www.thekelleys.org.uk/dnsmasq/doc.html"><code>dnsmasq</code></a> (recommended), OR</li>
<li>
<a href="http://members.home.nl/p.a.rombouts/pdnsd/index.html"><code>pdnsd</code></a> (untested)</li>
</ul><p>A pseudo-server that serves blank pages in order to remove the boilerplate page and speed up page resolution on blocked domains. Examples include:</p>

<ul>
<li>
<a href="https://code.google.com/p/kwakd/"><code>kwakd</code></a> (recommended), OR</li>
<li><a href="http://proxytunnel.sourceforge.net/pixelserv.php"><code>pixelserv</code></a></li>
</ul><h1>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h1>

<p>On an Arch Linux system, you can install hostsblock through AUR utilities such as <a href="https://aur.archlinux.org/packages.php?ID=5863"><code>yaourt</code></a>. If you are not running an Arch Linux system (which you should), follow these steps:</p>

<ol>
<li><p>Make sure you have all of the <em>required dependencies</em> above, and that they are in your path.</p></li>
<li><p>Download the latest stable source file from the <a href="https://aur.archlinux.org/packages/ho/hostsblock/hostsblock.tar.gz">AUR</a> or get the <a href="https://github.com/gaenserich/hostsblock/tarball/master">unstable version</a></p></li>
<li><p>Extract the source files from the archive, and then enter the extracted hostsblock directory in a terminal.</p></li>
<li>
<p>Execute the following <strong>as root</strong> or with <code>sudo</code>:</p>

<pre><code>install -Dm755 hostsblock.sh /usr/sbin/hostsblock
install -Dm755 hostsblock-urlcheck.sh /usr/sbin/hostsblock-urlcheck
install -Dm644 rc.conf /etc/hostsblock/rc.conf
install -Dm644 black.list /etc/hostsblock/black.list
install -Dm644 white.list /etc/hostsblock/white.list
install -Dm644 hosts.head /etc/hostsblock/hosts.head
</code></pre>
</li>
<li><p>If you will be using <code>hostsblock</code> without a dns caching daemon, make sure to copy your existing <code>/etc/hosts</code> file to <code>/etc/hostsblock/hosts.head</code> and enable this destination file in <code>rc.conf</code>.</p></li>
<li>
<p>If you want to use <code>hostsblock-urlcheck</code> as a regular user (without having to change to root each time you use it), enter the following via <code>visudo</code> <strong>as root</strong>:</p>

<pre><code>[yourusername] ALL=NOPASSWD: /usr/sbin/hostsblock-urlcheck
</code></pre>

<p>Where <code>[yourusername]</code> is the regular user you allow to use <code>hostsblock-urlcheck</code>.</p>
</li>
<li>
<p>Once enabled, you can use this utility by entering:</p>

<pre><code>$ sudo hostsblock-urlcheck "http://www.example.org"
</code></pre>

<p>to check if "<a href="http://www.example.org">http://www.example.org</a>" and any domains present on this page are blocked or unblocked and to change them accordingly.</p>
</li>
</ol><h1>
<a name="configuration" class="anchor" href="#configuration"><span class="octicon octicon-link"></span></a>Configuration</h1>

<p>Extensive documentation is found in the <code>rc.conf</code> file (installed by default under <code>/etc/hostsblock/rc.conf</code>). Follow the directions therein before running <code>hostsblock</code>. For more details on specific configurations, follow these instructions:</p>

<h4>
<a name="if-you-want-to-run-hostsblock-with-a-dns-caching-server-eg-dnsmasq" class="anchor" href="#if-you-want-to-run-hostsblock-with-a-dns-caching-server-eg-dnsmasq"><span class="octicon octicon-link"></span></a>If you want to run <code>hostsblock</code> with a dns caching server, e.g. dnsmasq:</h4>

<ol>
<li><p>Install <code>dnsmasq</code> (e.g. via <code>pacman -S dnsmasq</code>).</p></li>
<li><p><a href="https://wiki.archlinux.org/index.php/Dnsmasq#DNS_Cache_Setup">Configure dnsmasq as a local caching server.</a></p></li>
<li>
<p>Add the following to <code>/etc/dnsmasq.conf</code>:</p>

<pre><code>hostsfile="/etc/hosts.block" 
</code></pre>

<pre><code>postprocess(){ 
systemctl restart dnsmasq.service 
}
</code></pre>

<p>Where "systemctl restart dnsmasq.server" is your system's command to restart <code>dnsmasq</code>.</p>
</li>
</ol><p>From now on, whenever <code>hostsblock</code> runs, or if <code>hostsblock-urlcheck</code> makes changes, <code>dnsmasq</code> will automatically be restarted.</p>

<h4>
<a name="if-you-want-to-run-hostsblock-without-a-dns-caching-server" class="anchor" href="#if-you-want-to-run-hostsblock-without-a-dns-caching-server"><span class="octicon octicon-link"></span></a>If you want to run <code>hostsblock</code> without a dns caching server:</h4>

<ol>
<li>
<p>Make sure you back up your existing <code>/etc/hosts</code> file to <code>/etc/hostsblock/hosts.head</code>:</p>

<pre><code>$ cp /etc/hosts /etc/hostsblock/hosts.head
</code></pre>
</li>
<li>
<p>In <code>/etc/hostsblock/rc.conf</code>, make sure the following variables are entered as shown here:</p>

<pre><code>hostsfile="/etc/hosts" 
</code></pre>

<pre><code>postprocess(){ 
/bin/true 
} 
</code></pre>

<pre><code>hostshead="/etc/hostsblock/hosts.head"
</code></pre>
</li>
</ol><h1>
<a name="todo" class="anchor" href="#todo"><span class="octicon octicon-link"></span></a>Todo</h1>

<p>Drop me any suggestions in the <a href="https://bbs.archlinux.org/viewtopic.php?id=139784">Arch Linux Forum</a> that you might have, or feel free to fork via github. Other ideas:</p>

<ul>
<li>Port to Perl or Python to improve string processing performance.</li>
<li>Make use of <a href="https://www.gnu.org/software/parallel/">GNU Parallel</a> to speed up download times and processing, possibly at the risk of a perl dependency.</li>
<li>Autodectect archiving utils in order to compress archived hosts file.</li>
</ul>
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/gaenserich">gaenserich</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="http://twitter.com/#!/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>